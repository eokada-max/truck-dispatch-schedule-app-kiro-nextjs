# デプロイ準備チェックリスト

このドキュメントは、配送業向けスケジュール管理アプリケーションをデプロイする前の確認事項をまとめています。

## 1. Supabaseプロジェクトのセットアップ

### 1.1 プロジェクト作成

- [ ] [Supabase](https://supabase.com)にアクセスしてサインアップ/ログイン
- [ ] 「New Project」をクリック
- [ ] プロジェクト名を入力（例：truck-dispatch-schedule-app）
- [ ] データベースパスワードを設定（安全な場所に保存）
- [ ] リージョンを選択（日本の場合：Northeast Asia (Tokyo)推奨）
- [ ] プロジェクトが作成されるまで待機（約2分）

### 1.2 データベーススキーマの実行

- [ ] Supabase Dashboard > SQL Editorを開く
- [ ] `supabase/schema.sql`の内容をコピー
- [ ] SQL Editorに貼り付けて「Run」をクリック
- [ ] 全てのテーブルとインデックスが正常に作成されたことを確認

### 1.3 サンプルデータの投入（オプション）

- [ ] `supabase/sample_data.sql`の内容をコピー
- [ ] SQL Editorで実行
- [ ] クライアント、協力会社、ドライバーのデータが投入されたことを確認

## 2. 環境変数の設定

### 2.1 Supabase接続情報の取得

- [ ] Supabase Dashboard > Settings > APIを開く
- [ ] 以下の情報をコピー：
  - Project URL
  - anon public key

### 2.2 ローカル環境変数の設定

- [ ] `.env.local.template`を`.env.local`にコピー

```bash
cp .env.local.template .env.local
```

- [ ] `.env.local`を編集して実際の値を入力

```env
NEXT_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
```

- [ ] `.env.local`が`.gitignore`に含まれていることを確認

## 3. ローカル環境での動作確認

### 3.1 依存関係のインストール

```bash
npm install
```

### 3.2 開発サーバーの起動

```bash
npm run dev
```

### 3.3 動作確認項目

- [ ] http://localhost:3000 にアクセスできる
- [ ] トップページが正常に表示される
- [ ] スケジュール管理ページに遷移できる
- [ ] タイムラインが表示される
- [ ] スケジュール登録ボタンをクリックしてモーダルが開く
- [ ] スケジュールを登録できる
- [ ] 登録したスケジュールがタイムラインに表示される
- [ ] スケジュールをクリックして編集できる
- [ ] スケジュールを削除できる
- [ ] 日付ナビゲーション（前へ、次へ、今日）が動作する
- [ ] エラーメッセージが適切に表示される
- [ ] トーストメッセージが表示される

### 3.4 ビルドの確認

```bash
npm run build
```

- [ ] ビルドが成功する
- [ ] エラーや警告がないことを確認

### 3.5 型チェック

```bash
npm run type-check
```

- [ ] 型エラーがないことを確認（Supabaseの既知の型エラーは除く）

## 4. Vercelへのデプロイ

### 4.1 Vercelプロジェクトの作成

- [ ] [Vercel](https://vercel.com)にアクセスしてサインアップ/ログイン
- [ ] 「New Project」をクリック
- [ ] GitHubリポジトリを接続
- [ ] リポジトリを選択：`truck-dispatch-schedule-app-kiro-nextjs`

### 4.2 環境変数の設定

- [ ] Vercel > Project Settings > Environment Variablesを開く
- [ ] 以下の環境変数を追加：

| Name | Value |
|------|-------|
| `NEXT_PUBLIC_SUPABASE_URL` | Supabaseプロジェクトのurl |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Supabaseのanon key |

- [ ] 環境を選択：Production, Preview, Development全てにチェック

### 4.3 デプロイ設定

- [ ] Framework Preset: Next.js（自動検出）
- [ ] Build Command: `npm run build`（デフォルト）
- [ ] Output Directory: `.next`（デフォルト）
- [ ] Install Command: `npm install`（デフォルト）

### 4.4 デプロイ実行

- [ ] 「Deploy」ボタンをクリック
- [ ] デプロイが完了するまで待機（約2-3分）
- [ ] デプロイが成功したことを確認

## 5. 本番環境での動作確認

### 5.1 基本動作確認

- [ ] デプロイされたURLにアクセス
- [ ] トップページが正常に表示される
- [ ] スケジュール管理ページが動作する
- [ ] CRUD操作が全て動作する
- [ ] レスポンシブデザインが適切に動作する（モバイル、タブレット、デスクトップ）

### 5.2 パフォーマンス確認

- [ ] ページの読み込み速度が適切
- [ ] タイムラインのスクロールがスムーズ
- [ ] モーダルの開閉がスムーズ

### 5.3 エラーハンドリング確認

- [ ] ネットワークエラー時の挙動
- [ ] バリデーションエラーの表示
- [ ] トーストメッセージの表示

## 6. セキュリティチェック

### 6.1 環境変数

- [ ] `.env.local`がGitにコミットされていない
- [ ] 本番環境の環境変数が正しく設定されている
- [ ] APIキーが公開されていない

### 6.2 Supabase設定

- [ ] Row Level Security (RLS)の設定（将来的に認証機能を追加する場合）
- [ ] データベースのバックアップ設定

## 7. ドキュメント確認

- [ ] README.mdが最新の情報に更新されている
- [ ] セットアップ手順が正確
- [ ] 技術スタックの情報が正確
- [ ] デプロイ手順が記載されている

## 8. 今後の改善項目（オプション）

### 機能追加

- [ ] ユーザー認証機能
- [ ] スケジュールの検索・フィルター機能
- [ ] スケジュールのエクスポート機能（CSV、PDF）
- [ ] 通知機能
- [ ] カレンダービュー
- [ ] ドラッグ&ドロップでのスケジュール移動

### パフォーマンス

- [ ] 画像の最適化
- [ ] キャッシング戦略の改善
- [ ] データベースクエリの最適化

### テスト

- [ ] ユニットテストの追加
- [ ] 統合テストの追加
- [ ] E2Eテストの追加

## トラブルシューティング

### ビルドエラー

**問題**: `npm run build`でエラーが発生する

**解決策**:
1. `node_modules`を削除して再インストール
   ```bash
   rm -rf node_modules
   npm install
   ```
2. `.next`フォルダを削除
   ```bash
   rm -rf .next
   ```

### Supabase接続エラー

**問題**: データが取得できない

**解決策**:
1. 環境変数が正しく設定されているか確認
2. Supabaseプロジェクトが起動しているか確認
3. ネットワーク接続を確認
4. ブラウザのコンソールでエラーメッセージを確認

### Vercelデプロイエラー

**問題**: Vercelでのデプロイが失敗する

**解決策**:
1. ビルドログを確認
2. 環境変数が正しく設定されているか確認
3. ローカルで`npm run build`が成功するか確認

## 完了

全ての項目をチェックしたら、デプロイ準備は完了です！

🎉 おめでとうございます！配送業向けスケジュール管理アプリケーションのデプロイ準備が整いました。
